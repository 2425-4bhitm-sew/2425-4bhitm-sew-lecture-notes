(function(m){function k(a,c,b,d){d=d||0;if(0<=a.id.indexOf(c))return d;classie.has(a,b)&&++d;return a.parentNode&&k(a.parentNode,c,b,d)}function f(a,c){return classie.has(a,c)?a:a.parentNode&&f(a.parentNode,c)}function l(a,c,b){this.el=a;this.trigger=c;a=this.defaults;for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);this.options=a;(this.support=Modernizr.csstransforms3d)&&this._init()}l.prototype={defaults:{type:"overlap",levelSpacing:40,backClass:"mp-back"},_init:function(){this.open=!1;this.level=
0;this.wrapper=document.getElementById("mp-pusher");this.levels=Array.prototype.slice.call(this.el.querySelectorAll("div.mp-level"));var a=this;this.levels.forEach(function(c,b){c.setAttribute("data-level",k(c,a.el.id,"mp-level"))});this.menuItems=Array.prototype.slice.call(this.el.querySelectorAll(".mobile-menu-item"));this.levelBack=Array.prototype.slice.call(this.el.querySelectorAll("."+this.options.backClass));this.eventtype="click";classie.add(this.el,"mp-"+this.options.type);this._initEvents()},
_initEvents:function(){var a=this,c=function(b){a._resetMenu();b.removeEventListener(a.eventtype,c)};this.trigger.addEventListener(this.eventtype,function(b){b.stopPropagation();b.preventDefault();a.open?a._resetMenu():(a._openMenu(),document.addEventListener(a.eventtype,function(b){var e;if(e=a.open){if(b=b.target){for(b=b.target||b.srcElement||b||!1;b&&b.id!=a.el.id;)b=b.parentNode||!1;b=!1!==b}else b=!1;e=!b}e&&c(this)}))});this.menuItems.forEach(function(b,c){var e=b.querySelector("div.mp-level");
e&&b.querySelector("a").addEventListener(a.eventtype,function(c){c.preventDefault();var d=$(this).text(),g=f(b,"mp-level").getAttribute("data-level");a.level<=g&&(g=b.querySelector("div.mobile-header-placeholder"),c.stopPropagation(),classie.add(f(b,"mp-level"),"mp-level-overlay"),a._openMenu(e,d,g),$(".mp-menu").scrollTop(0))})});this.levels.forEach(function(b,c){b.addEventListener(a.eventtype,function(c){c.stopPropagation();c=b.getAttribute("data-level");a.level>c&&(a.level=c,a._closeMenu())})});
this.levelBack.forEach(function(b,c){b.addEventListener(a.eventtype,function(c){c.preventDefault();var d=f(b,"mp-level").getAttribute("data-level");a.level<=d&&(c.stopPropagation(),a.level=f(b,"mp-level").getAttribute("data-level")-1,0===a.level?a._resetMenu():a._closeMenu())})})},_openMenu:function(a,c,b){++this.level;var d=(this.level-1)*this.options.levelSpacing;this._setTransform("translate3d(-"+("overlap"===this.options.type?this.el.offsetWidth+d:this.el.offsetWidth)+"px,0,0)");if(a){this._setTransform("",
a);for(var e=0,f=this.levels.length;e<f;++e){var h=this.levels[e];h==a||classie.has(h,"mp-level-open")||this._setTransform("translate3d(-100%,0,0) translate3d(-"+-1*d+"px,0,0)",h)}}1===this.level&&(classie.add(this.wrapper,"mp-pushed"),this.open=!0,$(".mlpush-nav").addClass("open-nav"));classie.add(a||this.levels[0],"mp-level-open");$(b).find("span").text(c)},_resetMenu:function(){this._setTransform("translate3d(100%,0,0)");this.level=0;classie.remove(this.wrapper,"mp-pushed");$(".mlpush-nav").removeClass("open-nav");
this._toggleLevels();this.open=!1},_closeMenu:function(){this._setTransform("translate3d(-"+("overlap"===this.options.type?this.el.offsetWidth+(this.level-1)*this.options.levelSpacing:this.el.offsetWidth)+"px,0,0)");this._toggleLevels();$(".mp-menu").scrollTop(0)},_setTransform:function(a,c){c=c||this.wrapper;c.style.WebkitTransform=a;c.style.MozTransform=a;c.style.transform=a},_toggleLevels:function(){for(var a=0,c=this.levels.length;a<c;++a){var b=this.levels[a];b.getAttribute("data-level")>=this.level+
1?(classie.remove(b,"mp-level-open"),classie.remove(b,"mp-level-overlay")):Number(b.getAttribute("data-level"))==this.level&&classie.remove(b,"mp-level-overlay")}}};m.mlPushMenu=l})(window);